# 8086 中断向量表的介绍
_Exported on 7/1/2025 at 09:41:26 GMT+8 from Cursor (1.1.6)_

---

**User**

8086 中断向量表，是啥，

---

**Cursor**

好的，我们来聊聊8086的中断向量表。

简单来说，**中断向量表（Interrupt Vector Table, IVT）** 就是一张存放在内存里的“地址簿”。当CPU需要处理一个“中断”事件时，它会通过这个表来查找并跳转到对应的处理程序。

下面详细解释一下：

### 1. 什么是“中断”？

在CPU执行程序的过程中，可能会遇到一些需要立即处理的紧急事件，比如：
*   **外部事件**：键盘按下一个键、鼠标移动。
*   **内部事件**：程序中出现除法错误、或者程序员主动调用 `int` 指令来请求操作系统服务。

当这些事件发生时，CPU会暂停当前正在执行的任务，去处理这个紧急事件，处理完了再回来继续执行之前的任务。这个“暂停-处理-返回”的过程就叫做**中断**。

### 2. 中断向量表是做什么的？

CPU需要知道每一种中断事件对应的处理程序（也叫 **中断服务程序, ISR**）放在内存的哪个位置。中断向量表就是专门用来存储这些地址的。

*   **位置**：它固定存放在内存最开始的1KB空间，物理地址从 `00000H` 到 `003FFH`。
*   **结构**：8086 CPU支持256种中断，中断号（也叫中断类型码）从 `0` 到 `255`。表里有256个表项，每个表项对应一个中断号。
*   **表项**：每个表项占用4个字节，存放着对应中断服务程序的入口地址（CS和IP）。
    *   **低2字节**：存放偏移地址 (IP)
    *   **高2字节**：存放段地址 (CS)



### 3. CPU如何使用中断向量表？

当一个类型为 `n` 的中断发生时，CPU会执行以下固定步骤：

1.  **计算地址**：CPU会自动计算出中断号 `n` 在中断向量表中的位置，公式是 `中断号 * 4`。
2.  **查找地址**：CPU到内存 `0000:(n * 4)` 的位置，读取4个字节。
3.  **设置CS:IP**：将读取到的前2个字节送入 `IP` 寄存器，后2个字节送入 `CS` 寄存器。
4.  **保存现场**：在跳转之前，CPU会依次将当前的标志寄存器(Flags)、CS、IP推入堆栈。这样做的目的是当中断处理完成后，可以通过 `iret` 指令恢复到原来的执行状态。
5.  **执行中断服务程序**：CPU跳转到新的 `CS:IP` 地址，开始执行中断服务程序。

#### 举个例子：`int 21h`

`int 21h` 是DOS系统中非常著名的功能调用中断。当程序执行 `int 21h` 指令时：
1.  CPU知道中断号是 `21h`。
2.  它计算出中断向量在表中的地址是 `21h * 4 = 84h`。
3.  CPU会去内存 `0000:0084` 的地方，读取4个字节的地址，加载到CS和IP寄存器。
4.  然后跳转去执行DOS提供的相应服务程序。

希望这个解释能帮助你理解！如果还有其他问题，随时可以提问。

---

**User**

我明白了，中断向量表的作用就是，让CPU通过查表，找到处理内部中断或外部中断 的程序。

---

**Cursor**

是的，你的理解非常准确！

可以把中断向量表形象地比喻成CPU的 **“应急预案联系表”**。

*   **事件（中断）** 发生了。
*   CPU根据 **事件编号（中断号）** 去查这个表。
*   表中记录着处理该事件的 **负责人（中断服务程序）** 的 **地址**。
*   CPU马上赶到这个地址去执行处理程序。

这个机制是计算机系统中硬件和软件能够高效协同工作的关键之一。

